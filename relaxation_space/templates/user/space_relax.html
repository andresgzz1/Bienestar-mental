{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="audio/">
    <title>Saludem - Espacio de Relajacion</title>
    <link rel="stylesheet" href="img/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="{% static 'styles/space.css' %}">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
</head>


<body id="body" style="height: 100vh; width: 100vw;" onclick="ocultarElementos()"> 

    <div class="box" id="boxPrincipal">
        <div class="container w-80 mt-5">
            <h1 class="text-light text-center mb-4" >Espacio de relajaci√≥n</h1>
            <div class="row justify-content-center">
                {% for space in spaces %}                
                <div class="pb-5 col-sm-12 col-md-6 col-lg-4">
                    <a href={% url 'relax_space_view' space.id %} class="btn btn-outline-secondary btn-lg btn-block" onclick="cambiar('Lluvia');">
                        <img src={{space.img_space.url}} alt=""style="border-radius: 50%; background-size: cover; width: 100px; height: 100px;">
                        <h5>{{space.space_name}}</h5>
                        <div class="musica">
                            <audio controls src="audio/viento.mp3"></audio>
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
        {% if user.is_admin %}
        <div class="bar-superior d-flex justify-content-center">
            <a class= "col-md-auto"href={% url 'adminView_rp' %}>
                <button class="btn btn-outline-light">Configurar</button>
            </a>
        </div>
        {% endif %}
        
        
        
        <script>
            {% comment %} function cambiar() {





                    {% for gif in gifs %}
                        {% if forloop.counter == 1 %}
                            var gif_image = "{{ gif.gif_space.url }}";
                            console.log(gif_image);
                            document.getElementById('body').style.backgroundImage='url('+gif_image+')';
                        {% else %}
        
                        setTimeout(() => {
                            var gif_image = "{{ gif.gif_space.url }}";
                            console.log(gif_image);
                            document.getElementById('body').style.backgroundImage='url('+gif_image+')';
                        }, 3000);
                        {% endif %}
                    {% endfor %}



            }
        

            cambiar() {% endcomment %}

            var gifs_all = [
                {% for gif in gifs %}
                    "{{ gif.gif_space.url }}",
                {% endfor %}
            ]
            console.log(gifs_all);

            
            
            // Returns a Promise that resolves after "ms" Milliseconds
            const timer = ms => new Promise(res => setTimeout(res, ms))

            async function load () { // We need to wrap the loop into an async function for this to work
                for (var i = 0; i < gifs_all.length; i++) {
                    document.getElementById('body').style.backgroundImage='url('+gifs_all[i]+')';
                    console.log(i);
                    await timer(6000); // then the created Promise can be awaited
                }
                load();
            }

            load();


            {% comment %} function myLoop2(){

                gifs_all.forEach(function(gif, index) {
                    setTimeout(() => {
                        document.getElementById('body').style.backgroundImage='url('+gif+')';
                        console.log(gif);
                        if (index == gifs_all.length - 1) {
                            myLoop2();
                        }
                    }, 3000 * index);
                });
                
            };

            myLoop2(); {% endcomment %}

            {% comment %} var i = 1;                  //  set your counter to 1

            function myLoop() {         //  create a loop function
            setTimeout(function() {   //  call a 3s setTimeout when the loop is called
                
                var gif_image = "{{ gifs.0.gif_space.url }}";         
                document.getElementById('body').style.backgroundImage='url('+gif_image+')';
                console.log(gif_image);

                i++;                    //  increment the counter
                if (i < 10) {           //  if the counter < 10, call the loop function
                    myLoop();             //  ..  again which will trigger another 
                }                       //  ..  setTimeout()
            }, 3000)
            }

            myLoop();        {% endcomment %}            //  start the loop
            
            function ocultar_now_Elementos(){
                var x = document.getElementById("boxPrincipal");
                x.style.visibility = "hidden";
            }
            
            ocultar_now_Elementos();
            function ocultarElementos() {
                var x = document.getElementById("boxPrincipal");
                if (x.style.visibility === "hidden") {
                    x.style.visibility = "visible";
                } else {
                    x.style.visibility = "hidden";
                }
            }
    
            
            
            </script>
    </div>
</body>
</html>
